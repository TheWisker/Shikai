{"version":3,"names":["declare","api","assertVersion","hasRefOrSpread","attrs","i","length","attr","t","isJSXSpreadAttribute","isJSXAttributeOfName","name","isJSXAttribute","isJSXIdentifier","visitor","helper","filter","node","type","openingElement","attributes","pre","state","tagName","args","react","isCompatTag","push","stringLiteral","tagExpr","post","pass","callee","addHelper","props","hasKey","isObjectExpression","keyIndex","properties","findIndex","prop","isIdentifier","key","splice","value","isNullLiteral","objectExpression","unaryExpression","numericLiteral","pure"],"sources":["../src/index.ts"],"sourcesContent":["import { declare } from \"@babel/helper-plugin-utils\";\nimport helper from \"@babel/helper-builder-react-jsx\";\nimport { types as t } from \"@babel/core\";\n\nexport default declare(api => {\n  api.assertVersion(7);\n\n  function hasRefOrSpread(attrs: t.JSXOpeningElement[\"attributes\"]) {\n    for (let i = 0; i < attrs.length; i++) {\n      const attr = attrs[i];\n      if (t.isJSXSpreadAttribute(attr)) return true;\n      if (isJSXAttributeOfName(attr, \"ref\")) return true;\n    }\n    return false;\n  }\n\n  function isJSXAttributeOfName(attr: t.JSXAttribute, name: string) {\n    return (\n      t.isJSXAttribute(attr) && t.isJSXIdentifier(attr.name, { name: name })\n    );\n  }\n\n  const visitor = helper({\n    filter(node) {\n      return (\n        node.type === \"JSXElement\" &&\n        !hasRefOrSpread(node.openingElement.attributes)\n      );\n    },\n    pre(state) {\n      const tagName = state.tagName;\n      const args = state.args;\n      if (t.react.isCompatTag(tagName)) {\n        args.push(t.stringLiteral(tagName));\n      } else {\n        args.push(state.tagExpr);\n      }\n    },\n    post(state, pass) {\n      state.callee = pass.addHelper(\"jsx\");\n      // NOTE: The arguments passed to the \"jsx\" helper are:\n      //   (element, props, key, ...children) or (element, props)\n      // The argument generated by the helper are:\n      //   (element, { ...props, key }, ...children)\n\n      const props = state.args[1];\n      let hasKey = false;\n      if (t.isObjectExpression(props)) {\n        const keyIndex = props.properties.findIndex(prop =>\n          // @ts-expect-error todo(flow->ts) key does not exist on SpreadElement\n          t.isIdentifier(prop.key, { name: \"key\" }),\n        );\n        if (keyIndex > -1) {\n          // @ts-expect-error todo(flow->ts) value does not exist on ObjectMethod\n          state.args.splice(2, 0, props.properties[keyIndex].value);\n          props.properties.splice(keyIndex, 1);\n          hasKey = true;\n        }\n      } else if (t.isNullLiteral(props)) {\n        state.args.splice(1, 1, t.objectExpression([]));\n      }\n\n      if (!hasKey && state.args.length > 2) {\n        state.args.splice(2, 0, t.unaryExpression(\"void\", t.numericLiteral(0)));\n      }\n\n      state.pure = true;\n    },\n  });\n  return {\n    name: \"transform-react-inline-elements\",\n    visitor,\n  };\n});\n"],"mappings":"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"}